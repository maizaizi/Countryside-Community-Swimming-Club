{%extends 'managerhome.html'%}
{%block subcontent%}
    <div class="container">
        <!--display the flash message after action-->
        {% for message in get_flashed_messages() %}            
        <div class="alert alert-danger text-center my-4" role="alert">
        <p class="pt-3"><b>{{ message }}</b></p>
        </div>  
        {% endfor %}
        <!--list all the members-->
        <div>
            <h3 class="text-center pt-5 mb-5">Timetable</h3>
        </div>
        <div class="row">
            <div class="col-2">
                <a href="{{url_for('manager.schedule_class_form')}}"><button type="button" class="btn btn-outline-success fw-bold">Add Timetable</button></a>
            </div>
            <div class="col-6 row mb-3 justify-content-center">
                <label for="filter" class="col-2 col-form-label"><b>Filter:</b></label>
                <div class=" col-6">
                    <select id="filter"  name="filter" class="form-select" aria-label="Default select example" >
                        <option selected value="dayofweek">Order by Day of Week</option>
                        <option  value="class_name">Order by Class Name</option>
                        <option  value="inactive_schedules">Show Inactive Schedules</option> 
                    </select>
                </div> 
            </div>
        </div>
        
        <div id="schedule-table">
            <table class="table table-success table-striped table-hover text-center my-3">
                <thead>
                    <tr>
                        <th scope="col">Day of Week</th>
                        <th scope="col">Class Name</th>
                        <th scope="col">Start Time</th>
                        <th scope="col">End Time</th>
                        <th scope="col">Pool</th>
                        <th scope="col">Lane</th>
                        <th scope="col">Instructor Name</th>
                        <th scope="col"></th>
                        <th scope="col"></th>  
                        <th scope="col"></th> 
                    </tr>
                </thead>
                <tbody>
                    {%for schedule in all_schedules%}
                        <tr>
                        {%for key,value in schedule.items()%}
                            {%if key!='schedule_id'%}
                            <td>{{value}}</td>
                            {%endif%}
                            {%endfor%}
                            <td><a href="{{url_for('manager.edit_schedule_form',schedule_id=schedule['schedule_id'])}}"><button type="button" class="btn btn-outline-success fw-bold">Edit</button></a></td>
                            <td><a href="{{url_for('manager.delete_schedule',schedule_id=schedule['schedule_id'])}}">
                                <button type="button" class="btn btn-outline-danger fw-bold">Delete</button></a></td>
                            <td><a href="{{url_for('manager.booking_info',schedule_id=schedule['schedule_id'])}}">
                                <button type="button" class="btn btn-success fw-bold">View Booking Details</button></a></td>
                        </tr>
                        {%endfor%}
                        
                      
                </tbody>  
            </table> 
        </div>
    </div>
<script>
    $(document).ready(function(){
        $('#filter').change(function(){
            var filter_value = $('#filter').val();
            $.ajax({
                url: '/manager/schedule_filter',
                type: 'POST',
                data: {filter: filter_value},
                success: function(response){
                    $('#schedule-table').empty();
                    $('#schedule-table').html(response);
                }
            });
        });
    });
</script>   
{%endblock%}